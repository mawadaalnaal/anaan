<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="google" content="notranslate" />

  <!-- CSP -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    base-uri 'self';
    img-src 'self' data: https:;
    script-src 'self' 'unsafe-inline';
    style-src 'self' 'unsafe-inline' https: https://fonts.googleapis.com;
    style-src-elem 'self' 'unsafe-inline' https: https://fonts.googleapis.com;
    font-src 'self' data: https://fonts.gstatic.com;
    frame-src 'self' blob: data: https://drive.google.com https://docs.google.com;
    connect-src 'self';
    object-src 'none';
    frame-ancestors 'none';
    upgrade-insecure-requests;
  ">

  <title>مشاريع - عنان</title>

  <!-- خطوط -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">

  <!-- أيقونات -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <!-- CSS محلي -->
  <link rel="stylesheet" href="summary.css">
  <link rel="stylesheet" href="Projects.css">
</head>
<body>
  <!-- الهيدر -->
  <header class="header">
    <div class="container">
      <div class="logo-container">
        <img src="img/لوغو فاتح.png" alt="لوغو عنان" class="logo-image">
      </div>
      <nav class="nav">
        <ul>
          <li><a href="index.html">الرئيسية</a></li>
          <li><a href="quotations.html">الاقتباسات</a></li>
          <li><a href="summary.html">التلخيص</a></li>
          <li><a href="documentation.html">التوثيق</a></li>
          <li><a href="videos.html">الفيديوهات</a></li>
          <li><a href="tahfizat.html">تحفيزات</a></li>
          <li><a href="projects.html">مشاريع</a></li>
          <li><a href="team.html">أعضاء الفريق</a></li>
        </ul>
      </nav>
      <button class="menu-toggle" aria-label="فتح القائمة"><i class="fa-solid fa-bars"></i></button>
    </div>
  </header>

  <!-- قسم المشاريع -->
  <section class="projects-wrap" id="Projects">
    <h2 class="projects-title">مشاريع</h2>
    <div class="projects-grid">

      <!-- مشروع 1 -->
      <article class="project-card">
        <img src="projects/project-1.jpg" class="project-image" alt="مشروع 1">
        <div class="project-actions">
          <!-- تحميل مباشر من درايف -->
          <a class="btn"
             href="https://drive.google.com/uc?export=download&id=1Bp_L3_Qha0jS0_vabW9ve71Pxsu1mTBt"
             download>
            <i class="fa-solid fa-download"></i> تحميل
          </a>
          <!-- مشاهدة داخل المودال -->
          <button type="button" class="btn view-btn"
                  data-pdf="https://drive.google.com/file/d/1Bp_L3_Qha0jS0_vabW9ve71Pxsu1mTBt/preview"
                  aria-label="مشاهدة">
            <i class="fa-solid fa-eye"></i> مشاهدة
          </button>
        </div>
      </article>

      <!-- انسخ هذا البلوك لمشاريع أخرى وغيّر روابط Drive + الصور -->

    </div>
  </section>

  <!-- مودال PDF -->
  <div class="pdf-modal" id="pdfModal" aria-hidden="true">
    <div class="pdf-modal__dialog">
      <div class="pdf-modal__header">
        <h3 id="pdfTitle">عرض الملف</h3>
        <div class="pdf-modal__tools">
          <a id="modalDownloadBtn" class="btn small" href="#" download>
            <i class="fa-solid fa-download"></i> تحميل
          </a>
          <button class="btn small ghost" id="modalCloseBtn" aria-label="إغلاق">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
      </div>
      <div class="pdf-modal__body">
        <iframe id="pdfViewer" class="pdf-frame" src="" title="PDF Viewer" allow="fullscreen"></iframe>
        <p style="padding:10px">
          إذا لم يظهر الملف يمكنك
          <a id="fallbackDownload" href="#" download>تحميله من هنا</a>.
        </p>
      </div>
    </div>
  </div>

  <!-- الفوتر -->
  <footer class="footer" id="contact">
    <div class="social-links">
      <a href="https://t.me/al3nan_12" target="_blank" class="social-link" rel="noopener"><i class="fab fa-telegram"></i></a>
      <a href="https://x.com/alananteam" target="_blank" class="social-link" rel="noopener"><i class="fab fa-x-twitter"></i></a>
      <a href="https://www.instagram.com/alanan.team" target="_blank" class="social-link" rel="noopener"><i class="fab fa-instagram"></i></a>
    </div>
    <p class="copyright">
      <a href="https://mawadaalnaal.github.io/portfolio/" target="_blank" rel="noopener">
        جميع الحقوق محفوظة © 2025 Mawadda Alnaal
      </a>
    </p>
  </footer>

  <!-- سكربت -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // قائمة الموبايل
    const menuToggle = document.querySelector('.menu-toggle');
    if (menuToggle) {
      menuToggle.addEventListener('click', () => {
        const navList = document.querySelector('.nav ul');
        if (navList) navList.classList.toggle('show');
      });
    }

    const modal  = document.getElementById('pdfModal');
    const viewer = document.getElementById('pdfViewer');
    const modalDownload = document.getElementById('modalDownloadBtn');
    const fallbackDownload = document.getElementById('fallbackDownload');
    const closeBtn = document.getElementById('modalCloseBtn');

    function isSameOrigin(url) {
      try { const u = new URL(url, location.href); return u.origin === location.origin; }
      catch { return false; }
    }

    async function exists(url) {
      if (!isSameOrigin(url)) return true; // خارجي: اعتبره موجود
      try { const r = await fetch(url, { method: 'HEAD' }); return r.ok; }
      catch { return false; }
    }

    function openPdfModal(pdfPreviewUrl, downloadUrl) {
      viewer.src = pdfPreviewUrl;
      modalDownload.href = downloadUrl || pdfPreviewUrl;
      fallbackDownload.href = downloadUrl || pdfPreviewUrl;
      modal.classList.add('show');
      modal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
    }

    function closePdfModal() {
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden', 'true');
      viewer.src = '';
      document.body.style.overflow = '';
    }

    closeBtn && closeBtn.addEventListener('click', closePdfModal);
    modal && modal.addEventListener('click', (e) => { if (e.target === modal) closePdfModal(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closePdfModal(); });

    document.body.addEventListener('click', async (e) => {
      const btn = e.target.closest('.view-btn');
      if (!btn) return;

      e.preventDefault();
      const pdfPreviewUrl = btn.getAttribute('data-pdf');
      if (!pdfPreviewUrl) return;

      const isSmall = matchMedia('(max-width:640px)').matches;
      const isIOS = /iPad|iPhone|iPod/i.test(navigator.userAgent);

      const ok = await exists(pdfPreviewUrl);
      if (!ok) {
        alert('تعذّر العثور على الملف. تحقق من الرابط.');
        return;
      }

      if (isSmall || isIOS) {
        window.open(pdfPreviewUrl, '_blank', 'noopener');
      } else {
        openPdfModal(pdfPreviewUrl, btn.getAttribute('data-download'));
      }
    });
  });
  </script>
</body>
</html>
